// Single-user portfolio schema - FlowCV style
// All entities are top-level and belong to the single authenticated user

generator client {
  provider = "prisma-client-js"
  output   = "../prisma/generated/client"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

//////////////////////////////////////
// PERSONAL INFO (SINGLE ENTRY ONLY)
//////////////////////////////////////

model Profile {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  // Basic info
  fullName String
  email    String
  phone    String?
  location String?

  // Professional summary
  title      String? // e.g., "Full Stack Engineer"
  summary    String? // Brief professional summary
  yearsOfExp Int?    // Years of experience

  // Rich text sections for homepage
  introText String? // Rich text intro paragraph
  aboutText String? // Rich text about content

  // Media & Links
  profileImageUrl String?
  cvUrl           String? // Link to downloadable CV/PDF
  linkedinUrl     String?
  githubUrl       String?
  websiteUrl      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//////////////////////////////////////
// TOP-LEVEL ENTITIES (NO RELATIONS)
//////////////////////////////////////

model Experience {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  title          String
  companyName    String?
  location       String?
  locationType   String? // Remote / Onsite / Hybrid
  employmentType String? // Full-time / Part-time / Contract / Intern

  description    String // Rich text
  icon           String?
  companyLogoUrl String?

  startDate DateTime
  endDate   DateTime?
  current   Boolean  @default(false)

  order Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([startDate])
  @@index([order])
}

model Education {
  id          String @id @default(auto()) @map("_id") @db.ObjectId
  institution String
  degree      String

  startDate   DateTime
  endDate     DateTime?
  current     Boolean  @default(false)
  description String? // Optional field/major description

  order Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([startDate])
  @@index([order])
}

model Skill {
  id       String  @id @default(auto()) @map("_id") @db.ObjectId
  title    String  @unique // Globally unique since single user
  category String? // e.g., "Frontend", "Backend", "DevOps"
  level    Int?    // Optional proficiency level 1-5

  order Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([order])
  @@index([category])
}

model Project {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String // Rich text
  tags        String[]

  imageUrl  String?
  liveUrl   String?
  githubUrl String?

  order Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([order])
}

//////////////////////////////////////
// RESUME - REFERENCES IDS ONLY
//////////////////////////////////////

model Resume {
  id    String @id @default(auto()) @map("_id") @db.ObjectId
  title String

  // Visual customization
  themeColor String @default("#000000")
  layout     String @default("modern")

  // Content selection - store IDs of what to include
  // This allows user to pick and choose what goes in each resume
  experienceIds String[] @db.ObjectId
  educationIds  String[] @db.ObjectId
  skillIds      String[] @db.ObjectId
  projectIds    String[] @db.ObjectId

  // Custom content specific to this resume (optional overrides)
  // Stores: { personal: {...}, summary: "...", customExperiences: [...], etc. }
  content Json?

  version Int @default(1)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([createdAt])
}
